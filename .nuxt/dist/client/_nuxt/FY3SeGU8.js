import{u as X}from"./Hqu9efcG.js";import{d as Y,r as v,k as Z,o as H,M as k,C as t,Z as J,y as w,B as l,N,V as A,O as i,z as o,a5 as m,D as r,P as d,W as K,A as n,T as c,Y as _,a4 as V,a9 as h,al as ee,af as B,a7 as T,X as L,a2 as le,ah as te,ai as q,aj as z}from"./-SV6uRVe.js";import{_ as ae}from"./DlAUqK2U.js";const se={class:"d-flex justify-space-between align-center mb-4"},oe={class:"text-h5 primary--text"},ue={class:"text-h5 success--text"},de={class:"text-h5 info--text"},ne={class:"font-weight-medium"},ie={class:"text-caption text-grey"},re={class:"text-caption text-grey"},pe={class:"text-truncate",style:{"max-width":"200px"}},me={class:"d-flex gap-1"},ve={class:"text-h5"},fe={class:"text-h5"},ce=Y({__name:"suppliers",setup(_e){const s=X(),M=[{title:"Name",key:"name"},{title:"Contact",key:"contact",sortable:!1},{title:"Address",key:"address",sortable:!1},{title:"Status",key:"isActive",width:"120px"},{title:"Cylinders",key:"cylindersCount",width:"100px"},{title:"Actions",key:"actions",sortable:!1,width:"150px"}],D=v(""),P=v(""),g=v(!1),x=v(!1),y=v(!1),C=v(!1),U=v(!1),p=v({name:"",contactPerson:"",phone:"",email:"",address:"",latitude:void 0,longitude:void 0}),S=v(null),b={required:u=>!!u||"Required.",email:u=>!u||/.+@.+\..+/.test(u)||"Invalid email format."},F=Z(()=>{let u=s.suppliers;if(D.value){const e=D.value.toLowerCase();u=u.filter(a=>{var f;return a.name.toLowerCase().includes(e)||a.contactPerson.toLowerCase().includes(e)||a.phone.includes(e)||((f=a.email)==null?void 0:f.toLowerCase().includes(e))})}if(P.value!==""){const e=P.value==="active";u=u.filter(a=>a.isActive===e)}return u}),R=[{value:"active",title:"Active"},{value:"inactive",title:"Inactive"}],j=()=>{C.value=!1,p.value={name:"",contactPerson:"",phone:"",email:"",address:"",latitude:void 0,longitude:void 0},g.value=!0},E=u=>{C.value=!0,p.value={name:u.name,contactPerson:u.contactPerson,phone:u.phone,email:u.email||"",address:u.address,latitude:u.latitude,longitude:u.longitude},s.selectedSupplier=u,g.value=!0,y.value=!1},O=u=>{s.selectedSupplier=u,y.value=!0},G=u=>{S.value=u,x.value=!0},Q=async()=>{S.value&&(console.log("Delete supplier:",S.value),x.value=!1,S.value=null)},W=async()=>{if(U.value)try{C.value&&s.selectedSupplier?console.log("Update supplier:",p.value):await s.createSupplier(p.value),I()}catch(u){console.error("Error saving supplier:",u)}},I=()=>{g.value=!1,s.clearSelectedSupplier(),p.value={name:"",contactPerson:"",phone:"",email:"",address:"",latitude:void 0,longitude:void 0}},$=async()=>{await s.fetchSuppliers()};return H(async()=>{await $()}),(u,e)=>(w(),k(J,null,{default:t(()=>[l(A,null,{default:t(()=>[l(i,null,{default:t(()=>[o("div",se,[e[17]||(e[17]=o("div",null,[o("h1",{class:"text-h4"},"Suppliers"),o("p",{class:"text-subtitle-1 text-grey"},"Manage your gas cylinder suppliers")],-1)),l(m,{color:"primary",size:"large",onClick:j,"prepend-icon":"mdi-plus"},{default:t(()=>e[16]||(e[16]=[r(" Add Supplier ")])),_:1,__:[16]})])]),_:1})]),_:1}),d(s).error?(w(),k(K,{key:0,type:"error",dismissible:"",class:"mb-4","onClick:close":d(s).clearError},{default:t(()=>[r(n(d(s).error),1)]),_:1},8,["onClick:close"])):N("",!0),l(A,{class:"mb-6"},{default:t(()=>[l(i,{cols:"12",sm:"6",md:"4"},{default:t(()=>[l(c,{class:"text-center"},{default:t(()=>[l(_,null,{default:t(()=>[o("div",oe,n(d(s).suppliers.length),1),e[18]||(e[18]=o("div",{class:"text-subtitle-1"},"Total Suppliers",-1))]),_:1,__:[18]})]),_:1})]),_:1}),l(i,{cols:"12",sm:"6",md:"4"},{default:t(()=>[l(c,{class:"text-center"},{default:t(()=>[l(_,null,{default:t(()=>[o("div",ue,n(d(s).activeSuppliers.length),1),e[19]||(e[19]=o("div",{class:"text-subtitle-1"},"Active Suppliers",-1))]),_:1,__:[19]})]),_:1})]),_:1}),l(i,{cols:"12",sm:"6",md:"4"},{default:t(()=>[l(c,{class:"text-center"},{default:t(()=>[l(_,null,{default:t(()=>[o("div",de,n(d(s).suppliers.length-d(s).activeSuppliers.length),1),e[20]||(e[20]=o("div",{class:"text-subtitle-1"},"Inactive Suppliers",-1))]),_:1,__:[20]})]),_:1})]),_:1})]),_:1}),l(c,{class:"mb-4"},{default:t(()=>[l(_,null,{default:t(()=>[l(A,null,{default:t(()=>[l(i,{cols:"12",md:"6"},{default:t(()=>[l(V,{modelValue:D.value,"onUpdate:modelValue":e[0]||(e[0]=a=>D.value=a),label:"Search suppliers...","prepend-inner-icon":"mdi-magnify",clearable:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(i,{cols:"12",md:"3"},{default:t(()=>[l(h,{modelValue:P.value,"onUpdate:modelValue":e[1]||(e[1]=a=>P.value=a),items:R,label:"Status",clearable:"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),l(i,{cols:"12",md:"3"},{default:t(()=>[l(m,{color:"primary",block:"",onClick:$,loading:d(s).loading},{default:t(()=>e[21]||(e[21]=[r(" Refresh ")])),_:1,__:[21]},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1}),l(c,null,{default:t(()=>[l(ee,{headers:M,items:F.value,loading:d(s).loading,"item-key":"id",class:"elevation-1","items-per-page":10},{"item.name":t(({item:a})=>[o("div",null,[o("div",ne,n(a.name),1),o("div",ie,n(a.contactPerson),1)])]),"item.contact":t(({item:a})=>[o("div",null,[o("div",null,n(a.phone),1),o("div",re,n(a.email||"No email"),1)])]),"item.address":t(({item:a})=>[o("div",pe,n(a.address),1)]),"item.isActive":t(({item:a})=>[l(B,{color:a.isActive?"success":"error",size:"small",class:"ma-1"},{default:t(()=>[r(n(a.isActive?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"item.cylindersCount":t(({item:a})=>{var f;return[r(n(((f=a.gasCylinders)==null?void 0:f.length)||0),1)]}),"item.actions":t(({item:a})=>[o("div",me,[l(m,{icon:"mdi-eye",size:"small",variant:"text",onClick:f=>O(a)},null,8,["onClick"]),l(m,{icon:"mdi-pencil",size:"small",variant:"text",onClick:f=>E(a)},null,8,["onClick"]),l(m,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:f=>G(a)},null,8,["onClick"])])]),_:1},8,["items","loading"])]),_:1}),l(T,{modelValue:g.value,"onUpdate:modelValue":e[10]||(e[10]=a=>g.value=a),"max-width":"600px",persistent:""},{default:t(()=>[l(c,null,{default:t(()=>[l(L,null,{default:t(()=>[o("span",ve,n(C.value?"Edit":"Add")+" Supplier",1)]),_:1}),l(_,null,{default:t(()=>[l(le,{ref:"supplierForm",modelValue:U.value,"onUpdate:modelValue":e[9]||(e[9]=a=>U.value=a)},{default:t(()=>[l(A,null,{default:t(()=>[l(i,{cols:"12",md:"6"},{default:t(()=>[l(V,{modelValue:p.value.name,"onUpdate:modelValue":e[2]||(e[2]=a=>p.value.name=a),label:"Company Name*",rules:[b.required],outlined:""},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(V,{modelValue:p.value.contactPerson,"onUpdate:modelValue":e[3]||(e[3]=a=>p.value.contactPerson=a),label:"Contact Person*",rules:[b.required],outlined:""},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(V,{modelValue:p.value.phone,"onUpdate:modelValue":e[4]||(e[4]=a=>p.value.phone=a),label:"Phone Number*",rules:[b.required],outlined:""},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(V,{modelValue:p.value.email,"onUpdate:modelValue":e[5]||(e[5]=a=>p.value.email=a),label:"Email",rules:[b.email],outlined:""},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12"},{default:t(()=>[l(te,{modelValue:p.value.address,"onUpdate:modelValue":e[6]||(e[6]=a=>p.value.address=a),label:"Address*",rules:[b.required],outlined:"",rows:"3"},null,8,["modelValue","rules"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(V,{modelValue:p.value.latitude,"onUpdate:modelValue":e[7]||(e[7]=a=>p.value.latitude=a),modelModifiers:{number:!0},label:"Latitude",type:"number",step:"any",outlined:""},null,8,["modelValue"])]),_:1}),l(i,{cols:"12",md:"6"},{default:t(()=>[l(V,{modelValue:p.value.longitude,"onUpdate:modelValue":e[8]||(e[8]=a=>p.value.longitude=a),modelModifiers:{number:!0},label:"Longitude",type:"number",step:"any",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),l(q,null,{default:t(()=>[l(z),l(m,{text:"",onClick:I},{default:t(()=>e[22]||(e[22]=[r("Cancel")])),_:1,__:[22]}),l(m,{color:"primary",onClick:W,loading:d(s).loading,disabled:!U.value},{default:t(()=>[r(n(C.value?"Update":"Create"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(T,{modelValue:x.value,"onUpdate:modelValue":e[12]||(e[12]=a=>x.value=a),"max-width":"400px"},{default:t(()=>[l(c,null,{default:t(()=>[l(L,{class:"text-h5"},{default:t(()=>e[23]||(e[23]=[r("Confirm Delete")])),_:1,__:[23]}),l(_,null,{default:t(()=>{var a;return[r(' Are you sure you want to delete "'+n((a=S.value)==null?void 0:a.name)+'"? This action cannot be undone. ',1)]}),_:1}),l(q,null,{default:t(()=>[l(z),l(m,{text:"",onClick:e[11]||(e[11]=a=>x.value=!1)},{default:t(()=>e[24]||(e[24]=[r("Cancel")])),_:1,__:[24]}),l(m,{color:"error",onClick:Q,loading:d(s).loading},{default:t(()=>e[25]||(e[25]=[r(" Delete ")])),_:1,__:[25]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(T,{modelValue:y.value,"onUpdate:modelValue":e[15]||(e[15]=a=>y.value=a),"max-width":"500px"},{default:t(()=>[d(s).selectedSupplier?(w(),k(c,{key:0},{default:t(()=>[l(L,null,{default:t(()=>[o("span",fe,n(d(s).selectedSupplier.name),1)]),_:1}),l(_,null,{default:t(()=>[l(A,null,{default:t(()=>[l(i,{cols:"6"},{default:t(()=>[e[26]||(e[26]=o("strong",null,"Contact Person:",-1)),r(" "+n(d(s).selectedSupplier.contactPerson),1)]),_:1,__:[26]}),l(i,{cols:"6"},{default:t(()=>[e[27]||(e[27]=o("strong",null,"Phone:",-1)),r(" "+n(d(s).selectedSupplier.phone),1)]),_:1,__:[27]}),l(i,{cols:"12"},{default:t(()=>[e[28]||(e[28]=o("strong",null,"Email:",-1)),r(" "+n(d(s).selectedSupplier.email||"N/A"),1)]),_:1,__:[28]}),l(i,{cols:"12"},{default:t(()=>[e[29]||(e[29]=o("strong",null,"Address:",-1)),r(" "+n(d(s).selectedSupplier.address),1)]),_:1,__:[29]}),d(s).selectedSupplier.latitude?(w(),k(i,{key:0,cols:"6"},{default:t(()=>[e[30]||(e[30]=o("strong",null,"Latitude:",-1)),r(" "+n(d(s).selectedSupplier.latitude),1)]),_:1,__:[30]})):N("",!0),d(s).selectedSupplier.longitude?(w(),k(i,{key:1,cols:"6"},{default:t(()=>[e[31]||(e[31]=o("strong",null,"Longitude:",-1)),r(" "+n(d(s).selectedSupplier.longitude),1)]),_:1,__:[31]})):N("",!0),l(i,{cols:"6"},{default:t(()=>[e[32]||(e[32]=o("strong",null,"Status:",-1)),l(B,{color:d(s).selectedSupplier.isActive?"success":"error",size:"small"},{default:t(()=>[r(n(d(s).selectedSupplier.isActive?"Active":"Inactive"),1)]),_:1},8,["color"])]),_:1,__:[32]}),l(i,{cols:"6"},{default:t(()=>{var a;return[e[33]||(e[33]=o("strong",null,"Gas Cylinders:",-1)),r(" "+n(((a=d(s).selectedSupplier.gasCylinders)==null?void 0:a.length)||0),1)]}),_:1,__:[33]})]),_:1})]),_:1}),l(q,null,{default:t(()=>[l(z),l(m,{text:"",onClick:e[13]||(e[13]=a=>y.value=!1)},{default:t(()=>e[34]||(e[34]=[r("Close")])),_:1,__:[34]}),l(m,{color:"primary",onClick:e[14]||(e[14]=a=>E(d(s).selectedSupplier))},{default:t(()=>e[35]||(e[35]=[r(" Edit ")])),_:1,__:[35]})]),_:1})]),_:1})):N("",!0)]),_:1},8,["modelValue"])]),_:1}))}}),ye=ae(ce,[["__scopeId","data-v-3e9847a8"]]);export{ye as default};
