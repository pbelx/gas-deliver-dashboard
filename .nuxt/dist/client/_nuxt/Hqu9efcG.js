import{J as u,K as o,L as p}from"./-SV6uRVe.js";const c=u("suppliers",{state:()=>({suppliers:[],loading:!1,error:null,selectedSupplier:null}),getters:{activeSuppliers:e=>e.suppliers.filter(r=>r.isActive),supplierOptions:e=>e.suppliers.filter(r=>r.isActive).map(r=>({value:r.id,text:r.name}))},actions:{async fetchSuppliers(){this.loading=!0,this.error=null;const e=o(),r=p();try{const i=await e.getAllSuppliers(r.token||void 0);this.suppliers=i}catch(i){this.error=i.message||"Failed to fetch suppliers",this.suppliers=[]}finally{this.loading=!1}},async fetchSupplierById(e){this.loading=!0,this.error=null;const r=o(),i=p();try{const t=await r.getSupplierById(e,i.token||void 0);return this.selectedSupplier=t,t}catch(t){throw this.error=t.message||"Failed to fetch supplier",this.selectedSupplier=null,t}finally{this.loading=!1}},async createSupplier(e){this.loading=!0,this.error=null;const r=o(),i=p();if(!i.token)throw this.error="Authentication token not found. Please login.",this.loading=!1,new Error(this.error);try{const t=await r.createSupplier(e,i.token);return this.suppliers.push(t),t}catch(t){throw this.error=t.message||"Failed to create supplier",t}finally{this.loading=!1}},async updateSupplier(e,r){var s;this.loading=!0,this.error=null;const i=o(),t=p();if(!t.token)throw this.error="Authentication token not found. Please login.",this.loading=!1,new Error(this.error);try{const l=await i.updateSupplier(e,r,t.token),n=this.suppliers.findIndex(a=>a.id===e);return n!==-1&&(this.suppliers[n]=l),((s=this.selectedSupplier)==null?void 0:s.id)===e&&(this.selectedSupplier=l),l}catch(l){throw this.error=l.message||"Failed to update supplier",l}finally{this.loading=!1}},async deleteSupplier(e){var t;this.loading=!0,this.error=null;const r=o(),i=p();if(!i.token)throw this.error="Authentication token not found. Please login.",this.loading=!1,new Error(this.error);try{await r.deleteSupplier(e,i.token);const s=this.suppliers.findIndex(l=>l.id===e);return s!==-1&&(this.suppliers[s].isActive=!1),((t=this.selectedSupplier)==null?void 0:t.id)===e&&(this.selectedSupplier=null),!0}catch(s){throw this.error=s.message||"Failed to delete supplier",s}finally{this.loading=!1}},clearError(){this.error=null},clearSelectedSupplier(){this.selectedSupplier=null}}});export{c as u};
